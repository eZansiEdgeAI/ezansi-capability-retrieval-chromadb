# ezansi-capability-retrieval-chromadb

ChromaDB Retrieval capability for eZansiEdgeAI.

**Contract name:** `chromadb-retrieval`  
**Provides:** `vector-search`, `text-embeddings`  
**Purpose:** Upload content, index it, and query it (RAG retrieval)

## Quick start

```bash
podman-compose up -d
./scripts/validate-deployment.sh

# Ingest
curl -s -X POST http://localhost:8801/collections/demo/documents \
  -H 'Content-Type: application/json' \
  -d '{"documents":[{"id":"doc1","text":"RAG is retrieval augmented generation."}]}' | jq

# Query
curl -s -X POST http://localhost:8801/collections/demo/query \
  -H 'Content-Type: application/json' \
  -d '{"query":"What is RAG?","top_k":3}' | jq

# Embeddings (embedding-only usage)
curl -s -X POST http://localhost:8801/embeddings \
  -H 'Content-Type: application/json' \
  -d '{"texts":["hello world","goodbye world"]}' | jq
```

## API

- `GET /health`
- `GET /.well-known/capability.json`
- `POST /embeddings` (embeddings)
- `POST /collections/{collection}/documents` (ingest)
- `POST /collections/{collection}/query` (retrieve)

## Notes

This capability is stack-local and API-only: other containers should call the capability API on port 8801.

ChromaDB runs as an internal service in `podman-compose.yml` and is not published as a host port.

Embeddings are generated by this capability via `fastembed` and may download model files on first run. A persistent cache volume is mounted at `/cache`.
